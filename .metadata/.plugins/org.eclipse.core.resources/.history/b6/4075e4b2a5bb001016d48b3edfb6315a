package com.app.process;

import java.io.IOException;
import java.nio.file.*;
import java.util.*;
import java.util.stream.*;

class Account1 {
    String name;
    String country;
    String accountNo;
    String ifscCode;
    double balance;
    
    public Account1(String name, String country, String accountNo, String ifscCode, double balance) {
        this.name = name;
        this.country = country;
        this.accountNo = accountNo;
        this.ifscCode = ifscCode;
        this.balance = balance;
    }
}
public class newone1 {
    public static void main(String[] args) {
        String filePath = "C:/Users/kunal/chubb_workspace/Paymentapp/src/payment/details.txt";
        processTransfers(filePath);
    }
    public static void processTransfers(String filePath) {
        try {
            List<String> allLines = Files.lines(Paths.get(filePath))
                    .filter(line -> !line.trim().isEmpty())
                    .collect(Collectors.toList());
            List<newone1> accounts = new ArrayList<>();
            double totalHDFCPaid = allLines.stream()
                    .map(line -> line.split(","))
                    .filter(data -> data.length == 11)
                    .map(data -> {
                        Account sender = new Account(
                                data[0], data[1], data[2], data[3], Double.parseDouble(data[4])
                        );
                        double transferAmount = Double.parseDouble(data[5]);
                        String transferMode = data[6];
                        Account receiver = new Account(
                                data[7], data[8], data[9], data[10], 0
                        );
                        if (transferAmount > 0 && sender.balance >= transferAmount) {
                            sender.balance -= transferAmount;
                            receiver.balance += transferAmount;
                            accounts.add(sender);
                            accounts.add(receiver);
                            return sender.ifscCode.startsWith("HDFC") ? transferAmount : 0.0;
                        } else {
                            System.out.println("Transfer failed for " + sender.name + " to " + receiver.name);
                            return 0.0;
                        }
                    })
                    .reduce(0.0, Double::sum);
            accounts.stream()
                    .distinct();
            System.out.println("\n Total amount paid by HDFC Bank:" + totalHDFCPaid);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

